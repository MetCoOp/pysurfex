#!/usr/bin/env python3

import sys
import surfex
from datetime import datetime, timedelta

if __name__ == "__main__":

    # args = surfex.parse_args_ascii2sqlite(sys.argv[1:])
    variables = ["airTemperatureAt2M", "relativeHumidityAt2M", "totalSnowDepth"]
    bufrfile = "/home/trygveasp/revision_control/offline-surfex-forcing/testdata/ob2020022006"
    valid_dtg = datetime(year=2020, month=2, day=20, hour=6)
    valid_range = timedelta(seconds=3600)
    lonrange = [7, 12]
    latrange = [57, 62]

    bufr_set = surfex.BufrObservationSet(bufrfile, variables, valid_dtg, valid_range, lonrange=lonrange,
                                         latrange=latrange, label="bufr")

    bufr_set.write_json_file("bufr_data.json", indent=2)
